<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kalkulator Kiel Final</title>
<style>
*{box-sizing:border-box;margin:0;padding:0;}
body{
  background:#000;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  color:white;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:flex-end;
  overflow:hidden;
}

/* INTRO LOADING */
.intro{
  position:fixed; inset:0;
  background:#000;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  z-index:9999;
}
.progress-bar{
  width:230px;
  height:6px;
  background:#222;
  border-radius:10px;
  overflow:hidden;
  margin-top:15px;
}
.progress{
  height:100%;
  width:0%;
  background:#f5f5f5;
  animation:load 3.5s linear forwards;
}
@keyframes load{to{width:100%;}}
.dev{margin-top:15px;font-size:12px;color:#777;}

/* CALCULATOR */
.calculator{
  width:100%;
  max-width:400px;
  padding:20px;
  margin-bottom: 50px;
}
.display{
  text-align:right;
  font-size:42px;
  min-height:70px;
  margin-bottom:20px;
  word-break:break-all;
}
.buttons{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:12px;
}
button{
  height:75px;
  border:none;
  border-radius:50%;
  font-size:24px;
  background:#1c1c1c;
  color:white;
  transition:0.1s;
}
button:active{transform:scale(0.95);}
button.operator{background:#f5f5f5;color:black;}
button.gray{background:#505050;}
.zero{grid-column:span 2;border-radius:40px;text-align:left;padding-left:28px;}
button.delete{background:#505050;color:white;font-size:20px;}

/* FOTO CUSTOM POJOK KIRI ATAS */
.custom-icon{
  position:absolute; top:20px; left:20px;
  width:55px; height:55px;
  border-radius:50%;
  overflow:hidden;
  cursor:pointer;
  z-index:999;
}
.custom-icon img{width:100%;height:100%;object-fit:cover;}

/* MENU PAGE */
.page{
  position:fixed; inset:0;
  background:#000;
  display:none;
  padding:20px;
  transform-origin:left top;
}
.menu-item{
  padding:18px;
  border-bottom:1px solid #222;
  font-size:20px;
  cursor:pointer;
}
.back{margin-bottom:25px; cursor:pointer;}
.result-box{
  margin-top:20px;
  padding:15px;
  background:#111;
  border-radius:10px;
}
select,input{
  width:100%;
  padding:12px;
  margin-top:12px;
  background:#111;
  color:white;
  border:none;
  border-radius:8px;
  font-size:16px;
}

/* ANIMASI */
.fade-in{animation:fadeIn 0.4s forwards;}
@keyframes fadeIn{from{opacity:0;} to{opacity:1;}}
.scale-up{animation:scaleUp 0.3s ease forwards;}
@keyframes scaleUp{0%{transform:scale(0.8);opacity:0;}100%{transform:scale(1);opacity:1;}}
.scale-down{animation:scaleDown 0.3s ease forwards;}
@keyframes scaleDown{0%{transform:scale(1);opacity:1;}100%{transform:scale(0.8);opacity:0;}}
</style>
</head>
<body>

<!-- INTRO -->
<div class="intro">
<h1>Kalkulator Kiel</h1>
<div class="progress-bar"><div class="progress"></div></div>
<div class="dev">@devKielganteng_</div>
</div>

<!-- CALCULATOR -->
<div class="calculator" id="calculator">
<div class="display" id="display">0</div>
<div class="buttons">
<!-- Baris 1 -->
<button class="gray" onclick="clearAll()">AC</button>
<button class="delete" onclick="deleteOne()">⌫</button>
<button class="gray" onclick="toggleSign()">+/-</button>
<button class="operator" onclick="appendOperator('÷')">÷</button>
<!-- Baris 2 -->
<button onclick="appendNumber('1')">1</button>
<button onclick="appendNumber('2')">2</button>
<button onclick="appendNumber('3')">3</button>
<button class="operator" onclick="appendOperator('+')">+</button>
<!-- Baris 3 -->
<button onclick="appendNumber('4')">4</button>
<button onclick="appendNumber('5')">5</button>
<button onclick="appendNumber('6')">6</button>
<button class="operator" onclick="appendOperator('×')">×</button>
<!-- Baris 4 -->
<button onclick="appendNumber('7')">7</button>
<button onclick="appendNumber('8')">8</button>
<button onclick="appendNumber('9')">9</button>
<button class="operator" onclick="appendOperator('-')">−</button>
<!-- Baris 5 -->
<button class="zero" onclick="appendNumber('0')">0</button>
<button onclick="appendNumber('.')">.</button>
<button class="operator" onclick="calculate()">=</button>
</div>
</div>

<!-- FOTO CUSTOM -->
<div class="custom-icon" id="customIcon">
<img src="foto custom.jpg" alt="Custom Icon">
</div>

<!-- MENU -->
<div id="menuPage" class="page">
<div class="back" onclick="closeMenu()">← Kembali</div>
<div class="menu-item" onclick="openAge()">Usia</div>
<div class="menu-item" onclick="openCurrency()">Mata Uang</div>
<div class="menu-item" onclick="openMusic()">Music</div>
</div>

<!-- USIA -->
<div id="agePage" class="page">
<div class="back" onclick="backMenu()">← Kembali</div>
<h2>Kalkulator Usia</h2>
<select id="day"></select>
<select id="month"></select>
<select id="year"></select>
<button style="margin-top:15px;height:50px;border-radius:10px;background:#f5f5f5;color:black" onclick="calculateAge()">Hitung Usia</button>
<div class="result-box" id="ageResult"></div>
</div>

<!-- MATA UANG -->
<div id="currencyPage" class="page">
<div class="back" onclick="backMenu()">← Kembali</div>
<h2>IDR → USD</h2>
<input type="number" id="idrInput" placeholder="Masukkan IDR">
<button style="margin-top:15px;height:50px;border-radius:10px;background:#f5f5f5;color:black" onclick="convertCurrency()">Convert</button>
<div class="result-box" id="currencyResult"></div>
</div>

<!-- MUSIC -->
<div id="musicPage" class="page">
<div class="back" onclick="backMenu()">← Kembali</div>
<h2>Music</h2>
<button onclick="toggleMusic()" id="musicBtn">On/Off</button>
</div>

<script>
// INTRO
window.onload = () => {
  setTimeout(()=>{
    document.querySelector(".intro").style.display="none";
    document.getElementById("calculator").classList.add("fade-in");
    document.getElementById("customIcon").classList.add("fade-in");
  }, 3500);
  initDate();
};

// CALCULATOR
let expression="";
const display = document.getElementById("display");
function appendNumber(num){
  if(display.innerText==="0" && num!=="."){display.innerText=num; expression=num;}
  else{display.innerText+=num; expression+=num;}
}
function appendOperator(op){
  if(!expression) return;
  let last=expression.slice(-1);
  if(["+","-","×","÷"].includes(last)) return;
  display.innerText+=op; expression+=op;
}
function calculate(){
  try{
    let result=Function("return "+expression.replace(/×/g,"*").replace(/÷/g,"/"))();
    display.innerText=result.toLocaleString();
    expression=result.toString();
  }catch{
    display.innerText="Error"; expression="";
  }
}
function clearAll(){display.innerText="0"; expression="";}
function toggleSign(){if(!expression) return; let result=Function("return "+expression.replace(/×/g,"*").replace(/÷/g,"/"))()*-1; display.innerText=result.toLocaleString(); expression=result.toString();}
function deleteOne(){if(expression.length>0){expression=expression.slice(0,-1); display.innerText=expression||"0";}}

// MENU
const customIcon = document.getElementById("customIcon");
customIcon.addEventListener("click", ()=>{
  openMenu(); 
  customIcon.style.transform="scale(0.95)";
  setTimeout(()=>{customIcon.style.transform="scale(1)";},150);
});
function openMenu(){document.getElementById("menuPage").style.display="block"; document.getElementById("menuPage").classList.add("scale-up"); customIcon.style.display="none";}
function closeMenu(){document.getElementById("menuPage").classList.add("scale-down"); setTimeout(()=>{document.getElementById("menuPage").style.display="none"; customIcon.style.display="block";},300);}
function openAge(){document.getElementById("menuPage").style.display="none"; document.getElementById("agePage").style.display="block"; document.getElementById("agePage").classList.add("scale-up");}
function openCurrency(){document.getElementById("menuPage").style.display="none"; document.getElementById("currencyPage").style.display="block"; document.getElementById("currencyPage").classList.add("scale-up");}
function openMusic(){document.getElementById("menuPage").style.display="none"; document.getElementById("musicPage").style.display="block"; document.getElementById("musicPage").classList.add("scale-up");}
function backMenu(){
  document.getElementById("agePage").style.display="none"; 
  document.getElementById("currencyPage").style.display="none"; 
  document.getElementById("musicPage").style.display="none"; 
  document.getElementById("menuPage").style.display="block"; 
  document.getElementById("menuPage").classList.add("scale-up");
}

// USIA
function initDate(){
  for(let i=1;i<=31;i++) day.innerHTML+=`<option>${i}</option>`;
  const months=["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"];
  months.forEach((m,i)=>month.innerHTML+=`<option value="${i}">${m}</option>`);
  for(let y=1950;y<=new Date().getFullYear();y++) year.innerHTML+=`<option>${y}</option>`;
}
function calculateAge(){
  let birth=new Date(year.value,month.value,day.value);
  let today=new Date();
  let years=today.getFullYear()-birth.getFullYear();
  let months=today.getMonth()-birth.getMonth();
  let days=today.getDate()-birth.getDate();
  if(days<0){months--; days+=new Date(today.getFullYear(),today.getMonth(),0).getDate();}
  if(months<0){years--; months+=12;}
  ageResult.innerHTML=`<b>${years}</b> Tahun<br><b>${months}</b> Bulan<br><b>${days}</b> Hari`;
}

// CURRENCY
async function convertCurrency(){
  let amount=idrInput.value;
  if(!amount) return;
  try{
    let res=await fetch("https://open.er-api.com/v6/latest/IDR");
    let data=await res.json();
    let result=(amount*data.rates.USD).toFixed(2);
    currencyResult.innerHTML=`${amount} IDR = <b>${result} USD</b>`;
  }catch{
    let fallback=15500;
    let result=(amount/fallback).toFixed(2);
    currencyResult.innerHTML=`${amount} IDR ≈ <b>${result} USD</b> (offline)`;
  }
}

// MUSIC
const playlist=["lagu1.mp3","lagu2.mp3","lagu3.mp3"];
let audio=new Audio();
let currentTrack=0;
let isPlaying=false;
const musicBtn = document.getElementById("musicBtn");
function toggleMusic(){
  isPlaying=!isPlaying;
  if(isPlaying){playTrack(currentTrack); musicBtn.innerText="On";}
  else{audio.pause(); audio.currentTime=0; musicBtn.innerText="Off";}
}
function playTrack(index){
  if(!isPlaying) return;
  if(index>=playlist.length){isPlaying=false; musicBtn.innerText="Off"; return;}
  audio.src=playlist[index];
  audio.play();
  audio.onended=()=>{playTrack(index+1);}
}
</script>
</body>
</html>